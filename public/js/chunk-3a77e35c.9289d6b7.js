(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a77e35c"],{"0e3b":function(e,t,n){},"8a00":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-row",[n("b-col",{attrs:{xl:"6",lg:"6"}},[n("DevicesGrid")],1),n("b-col",{attrs:{xl:"6",lg:"6"}},[n("LastAlerts")],1)],1)],1)},i=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Visão Geral")]),n("b-row",{staticClass:"mt-4"},[0==e.devices.length?n("b-col",[e._v(" Você não possui Dispositivos autorizados ")]):e._e(),e._l(e.devices,(function(t){return n("b-col",{key:t.id,staticClass:"mb-3 text-center",attrs:{cols:"4"}},[n("div",{staticClass:"icons-parent"},[n("font-awesome-icon",{staticClass:"door-icon",class:{"text-danger":t.opened&&t.in_alert},attrs:{icon:t.opened?"door-open":"door-closed",size:"5x"}}),n("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:t.in_alert,expression:"device.in_alert"}],staticClass:"alert-icon text-danger",attrs:{icon:"exclamation",size:"2x"}})],1),n("div",{staticClass:"mt-1"},[e._v(e._s(t.name))])])}))],2)],1)},r=[],o=(n("c740"),{data:function(){return{device_search_id:null,devices:[]}},mounted:function(){this.getDevices(),this.$cable.subscribe({channel:"MeasurementChannel",room:"public",user_id:this.$auth.user().id})},channels:{MeasurementChannel:{connected:function(){},received:function(e){this.deviceOpenedChanged(e.device_id,e.opened)}}},methods:{getDevices:function(){var e=this;this.axios.get("/devices.json",{params:{authorized:!0}}).then((function(t){e.devices=t.data})).catch((function(e){console.log(e)}))},deviceOpenedChanged:function(e,t){var n=this.devices.findIndex((function(t){return t.id==e}));this.devices[n].opened=t}}}),c=o,l=(n("e1ef"),n("2877")),d=Object(l["a"])(c,s,r,!1,null,null,null),u=d.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Últimos Alertas")]),n("b-table",{staticClass:"mt-4",attrs:{striped:"",hover:"",items:e.alerts,fields:e.alerts_fields,"show-empty":"","empty-text":"Não ocorreram alertas"},scopedSlots:e._u([{key:"cell(finished_at)",fn:function(t){return["Invalid date"==t.value?n("span",[n("font-awesome-icon",{staticClass:"text-danger",attrs:{icon:"exclamation-triangle",size:"lg"}}),e._v(" Aberta ")],1):n("span",[e._v(e._s(t.value))])]}}])}),n("paginate",{attrs:{"page-count":e.pagination.total_pages,"click-handler":e.getAlerts,"prev-text":"Ante.","next-text":"Próx.","page-range":5,"margin-pages":2,"page-class":"pagination","container-class":"pagination justify-content-center"},model:{value:e.pagination.page,callback:function(t){e.$set(e.pagination,"page",t)},expression:"pagination.page"}})],1)},h=[],p={data:function(){var e=this;return{alerts:[],pagination:{total_pages:0,page:1},alerts_fields:[{key:"device_name",label:"Dispositivo"},{key:"started_at",label:"Início",formatter:function(t){return e.$moment(t).format("DD/MM/YYYY HH:mm:ss")}},{key:"finished_at",label:"Encerrado",formatter:function(t){return e.$moment(t).format("DD/MM/YYYY HH:mm:ss")}},{key:"duration",label:"Duração",formatter:function(t,n,a){var i=e.$moment(a.finished_at).from(e.$moment(a.started_at),!0);return"Invalid date"==i?"--":i}}]}},mounted:function(){this.getAlerts(),this.$cable.subscribe({channel:"AlertChannel",room:"public",user_id:this.$auth.user().id})},channels:{AlertChannel:{connected:function(){},received:function(e){"started"==e.action?this.getAlerts():"finished"==e.action&&this.updateAlertFinishedAt(e)}}},methods:{getAlerts:function(){var e=this;this.axios.get("/alerts.json",{params:{device_id:this.device_search_id,page:this.pagination.page}}).then((function(t){e.alerts=t.data,e.pagination.total_pages=parseInt(t.headers["total-pages"])}))},updateAlertFinishedAt:function(e){var t=this.alerts.findIndex((function(t){return t.id==e.id}));t<0||(this.alerts[t].finished_at=e.finished_at)}}},v=p,m=Object(l["a"])(v,f,h,!1,null,null,null),g=m.exports,_={components:{DevicesGrid:u,LastAlerts:g}},b=_,x=Object(l["a"])(b,a,i,!1,null,null,null);t["default"]=x.exports},ae40:function(e,t,n){var a=n("83ab"),i=n("d039"),s=n("5135"),r=Object.defineProperty,o={},c=function(e){throw e};e.exports=function(e,t){if(s(o,e))return o[e];t||(t={});var n=[][e],l=!!s(t,"ACCESSORS")&&t.ACCESSORS,d=s(t,0)?t[0]:c,u=s(t,1)?t[1]:void 0;return o[e]=!!n&&!i((function(){if(l&&!a)return!0;var e={length:-1};l?r(e,1,{enumerable:!0,get:c}):e[1]=1,n.call(e,d,u)}))}},b727:function(e,t,n){var a=n("0366"),i=n("44ad"),s=n("7b0b"),r=n("50c4"),o=n("65f0"),c=[].push,l=function(e){var t=1==e,n=2==e,l=3==e,d=4==e,u=6==e,f=5==e||u;return function(h,p,v,m){for(var g,_,b=s(h),x=i(b),A=a(p,v,3),C=r(x.length),w=0,y=m||o,$=t?y(h,C):n?y(h,0):void 0;C>w;w++)if((f||w in x)&&(g=x[w],_=A(g,w,b),e))if(t)$[w]=_;else if(_)switch(e){case 3:return!0;case 5:return g;case 6:return w;case 2:c.call($,g)}else if(d)return!1;return u?-1:l||d?d:$}};e.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6)}},c740:function(e,t,n){"use strict";var a=n("23e7"),i=n("b727").findIndex,s=n("44d2"),r=n("ae40"),o="findIndex",c=!0,l=r(o);o in[]&&Array(1)[o]((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!l},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},e1ef:function(e,t,n){"use strict";var a=n("0e3b"),i=n.n(a);i.a}}]);
//# sourceMappingURL=chunk-3a77e35c.9289d6b7.js.map